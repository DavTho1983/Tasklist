{% extends 'base.html' %}

{% block content %}

  <div class="container">
    <table class="table table-sm">
      <thead>
        <th class="align-text-top" scope="col">Task Title</th>
        <th class="align-text-top"  scope="col">Publication Date</th>
        <th class="align-text-top"  scope="col">Description</th>
        <th class="align-text-top"  scope="col">Completed</th>
        <th class="align-text-top"  scope="col">User</th>
        <th class="align-text-top"  scope="col"></th>
      </thead>
      <tbody>
        {% for task in tasks %}
          <tr {% if task.completed %} class="table-active" {% endif %}>
            <th scope="row">{{ task.title }}</th>
            <td>{{ task.pub_date_pretty }}</td>
            <td>{{ task.summary }}</td>
            <td><input type=checkbox onclick="return false;" onkeydown="return false;" {% if task.completed %} checked="checked" {% endif %}/></td>
            <td>{{ task.user }}</td>
            <td>
              {% if user.is_authenticated %}
                {% if request.user.is_superuser or request.user == task.user %}
                  <a class="btn btn-primary" href="{% url 'edit' task.id %}">Edit</a>
                  <form action="{% url 'markcompleted' task.id %}" method="POST">
                    {% csrf_token %}
                    <button class="btn btn-primary" type="submit">Mark Completed</button>
                  </form>
                {% endif %}
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>


<br>
<br>
  {% if user.is_authenticated %}
    <div class="container">
      <div class="row pt-9">
        <div class="col-9">
          <span></span>
        </div>
        <div class="col-3">
          <a class="btn btn-primary float-right" href="{% url 'create' %}">Add</a>
        </div>
      </div>
    </div>
    <br>
    <br>
  {% endif %}

{% endblock %}
